@[TOC](一种基于MFC构造自动测量系统)

> 本次接口技术课程设计主要涉及**基于MFC的编程**和**RS232通信协议**的数字程控应用，根据课程设计要求完成了这个简易的自动测量系统，本系统目前还可以继续完善，有相当多的功能可以继续添加。<p>
> 对于想要获取此**课程设计报告word/PDF排版**的同学，欢迎光顾小生寒舍  [GitHub: https://github.com/ChromeWei?tab=repositories](https://github.com/ChromeWei?tab=repositories) 也可点击[==我的下载==](//download.csdn.net/download/Charmve/12038003)进行下载，但需要积分。<br>
>  <font color =red >直接获取方式：关注微信公众号迈微电子研发社，回复“**接口技术课程设计**”，程序开发源代码。</font><br>
>  **特此感谢，** 课程设计过程中任课老师张老师给予的指导和帮助！<p>

<font face="黑体" size=4>==**摘要**==</font> 
&emsp;&emsp;现在，计算机的应用已经相当普遍，传统的测量仪器逐渐被数字化测量仪器所取代。连接的手工测量工作很多都更新换代为由计算机控制的自动测试系统，这是电子测量领域发展的必然趋势。
&emsp;&emsp;经过对本课程设计的分析，本构造自动测量系统将通过MFC上位机完成程控接口控制数字信号发生器输出激励信号，采用单文档方式显示响应信号波形，以达到课程设计的完成相关要求。信号发生器的程控接口，采用RS232硬件接口连接，根据程控命令格式与信号发生器通信，控制输出激励信号的幅度、频率等参数。同样地，使用USB-C与示波器相连，实现接口程序控制示波器工作。
&emsp;&emsp;通过MFC编写上位机显示采集到的信号波形，提供键鼠操作图像的缩放、保存等功能。经实际测试，不断调节激励信号的显示X、Y轴及参数，系统测量显示已达到稳定性、快速性、准确性的基本要求，能够较好的满足一般测试要求。<br>
<font face="黑体" size=4>**关键字：**</font>  MFC；RS232；数字信号发生器；示波器；数字程控<p><br><br>
![系统结构示意图](https://img-blog.csdnimg.cn/20191209150135880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoYXJtdmU=,size_16,color_FFFFFF,t_70#pic_center)
<center>多种波形发生电路自动测量系统结构示意图<br><br></center>
<br><br>

# 第一部分 课程设计概述
## 1 课程设计的目的与任务
### 1.1 使用智能仪器构造自动测量系统
&emsp;&emsp;自动测量是计算机控制下的测量过程，必须对单次测量有充分理解，才能实现连续的自动过程。

&emsp;&emsp;基本的测量过程都是： 
&emsp;&emsp;&emsp;&emsp;产生激励信号 -> 经过被测系统 -> 产生输出的响应信号<p>
 ![在这里插入图片描述](https://img-blog.csdnimg.cn/20191209175304312.png#pic_center)
<center>图1.1 测量原理图</center>

&emsp;&emsp;对激励信号与响应信号的分析，可以获得被测系统的特性。例如向直流分压电路施加一个电压信号，在输出端得到对应的分压电压。比较输出和输入的电压大小，可以得到该电路的分压比等特性。

### 1.2 使用MFC实现程序结构
&emsp;&emsp;实验使用 MFC 应用程序实现，对话框或 SDI、MDI 都可以，自己选择。

&emsp;&emsp;典型的测量系统有：<br>
&emsp;&emsp;&emsp;&emsp;交流电路的频率特性； <br>
&emsp;&emsp;&emsp;&emsp;二极管的电压-电流特性测量；<br>
&emsp;&emsp;&emsp;&emsp;直流放大特性的测量等等。<br>

&emsp;&emsp;<b>要求</b>：
&emsp;&emsp;&emsp;&emsp;基本要求是没有被测系统，直接使用示波器测量信号发生器的输出。<br>

## 2 课程设计题目
&emsp;&emsp;构造自动测量系统
## 3 设计功能要求
（1）在 windows 系统下通过接口与仪器实现通信<br>
&emsp;&emsp;常用的仪器接口有： USB，RS232C，以太网，GPIB，PCI 等。<br>
&emsp;&emsp;实验室中提供的有： 使用 RS232C 的程控信号发生器，数字直流电压表 PZ-150 使用 USB 的存储示波器<br>
&emsp;&emsp;接口只是硬件的实现，更重要的是程控命令的功能和定义。<br>

（2）在程序界面上显示激励信号；

（3）在程序界面上显示测量到的响应信号
&emsp;&emsp;智能示波器采用的是 USB 接口，但是使用 USB 中 CDC 方式构造了虚拟串口，因此在程序中表现为串口编程。<br>
&emsp;&emsp;采用边测量边画点的方法，可以画出响应波形。<br>

（4）在程序界面上显示测量系统的测量获得的结果特性
&emsp;&emsp;按照被测量特性的定义要求，由激励与响应计算出特性曲线。<br>

（5）扩展部分自选测量内容，设计被测系统（如滤波器的频率特性），实现完整的测量系统。

## 4 课程设计的内容与要求
（1）设计构造自动测量系统；<br>
（2）编写测量系统软件；<br>
（3）软硬件调试；<br>
（4）写课程设计报告。<br>

满怀热情地在此与各位同道中人交流学习，在整个仓库的整理汇总过程中，由于时间仓促，加之个人水平有限，文章中难免有疏漏和错误之处，恳请广大读者和专家指正，作者心怀感激！

<br>

<div align=center><img src="https://image.jiqizhixin.com/uploads/editor/d8595d93-e8c9-4abf-91f4-105384736912/%E5%9B%BE%E7%89%8712.jpg" height="330" width="330"></div>

<div align=center size = 3><b>△微信扫一扫，关注我</b></div>
